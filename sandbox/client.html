<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AXIOS | Sandbox</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"/>
  <style>
    /* --- Theme Variables --- */
    :root {
      --bg-color: #fff;
      --text-color: #212529;
      --well-bg: #f8f9fa;
      --border-color: #dee2e6;
      --axios-purple: #6a1b9a;
    }
    body.dark-mode {
      --bg-color: #121212;
      --text-color: #e9ecef;
      --well-bg: #1c1c1c;
      --border-color: #495057;
      --axios-purple: #a78bfa;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    .well {
      background-color: var(--well-bg);
      border: 1px solid var(--border-color);
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 5px;
    }

    input, textarea, select {
      background-color: var(--bg-color);
      color: var(--text-color);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .box {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }

    pre {
      background-color: var(--bg-color);
      padding: 10px;
      overflow: auto;
      border: 1px solid var(--border-color);
      border-radius: 5px;
    }

    @media (max-width: 768px) {
      .box {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body class="container py-4">

  <!-- Header -->
  <div class="header">
    <div style="display:flex; align-items:center;">
      <img src="https://axios-http.com/assets/logo.svg" alt="Axios" width="100">
      <h1 class="ms-2">Sandbox</h1>
    </div>
    <button id="theme-toggle" class="btn btn-outline-secondary">Dark Mode</button>
  </div>

  <!-- Main Box -->
  <div class="box">

    <!-- Input Form -->
    <div class="well">
      <h3>Input</h3>
      <form id="axios-form" onsubmit="return false;">
        <div class="mb-3">
          <label for="url">URL</label>
          <input id="url" type="url" class="form-control" placeholder="/api">
        </div>
        <div class="mb-3">
          <label for="method">Method</label>
          <select id="method" class="form-control">
            <option>GET</option>
            <option>POST</option>
            <option>PUT</option>
            <option>PATCH</option>
            <option>DELETE</option>
            <option>HEAD</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="params">Params (for GET/DELETE)</label>
          <textarea id="params" class="form-control" placeholder='{"foo": "bar"}'></textarea>
        </div>
        <div class="mb-3" id="data-group">
          <label for="data">Data (for POST/PUT/PATCH)</label>
          <textarea id="data" class="form-control" placeholder='{"foo": "bar"}'></textarea>
        </div>
        <div class="mb-3">
          <label for="headers">Headers</label>
          <textarea id="headers" class="form-control" placeholder='{"X-Requested-With": "XMLHttpRequest"}'></textarea>
        </div>
        <button id="submit" type="submit" class="btn btn-primary">Send Request</button>
      </form>
    </div>

    <!-- Response Display -->
    <div>
      <div class="well">
        <h3>Request <button id="copy-request" class="btn btn-sm btn-outline-secondary float-end">Copy</button></h3>
        <pre id="request">No Data</pre>
      </div>
      <div class="well">
        <h3>Response <button id="copy-response" class="btn btn-sm btn-outline-secondary float-end">Copy</button></h3>
        <pre id="response">No Data</pre>
      </div>
      <div class="well">
        <h3>Error <button id="copy-error" class="btn btn-sm btn-outline-secondary float-end">Copy</button></h3>
        <pre id="error">None</pre>
      </div>
    </div>

  </div>

  <!-- Request History -->
  <div class="well mt-3" id="history-container">
    <h3>Request History</h3>
    <ul id="request-history" style="list-style:none; padding-left:0;"></ul>
  </div>

  <!-- Footer -->
  <footer class="well text-center mt-4">
    <p><span style="color:var(--axios-purple)">AXIOS</span> | Sandbox Â© <span id="year"></span></p>
    <a href="https://axios-http.com/docs/intro" target="_blank">Docs</a> |
    <a href="https://github.com/axios/axios" target="_blank">GitHub</a> |
    <a href="https://axios-http.com/" target="_blank">Website</a>
  </footer>

  <!-- Axios JS -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

  <!-- Sandbox Script -->
  <script>
    // --- DOM Elements ---
    const url = document.getElementById('url');
    const method = document.getElementById('method');
    const params = document.getElementById('params');
    const data = document.getElementById('data');
    const dataGroup = document.getElementById('data-group');
    const headers = document.getElementById('headers');
    const submit = document.getElementById('submit');
    const requestEl = document.getElementById('request');
    const responseEl = document.getElementById('response');
    const errorEl = document.getElementById('error');
    const themeToggle = document.getElementById('theme-toggle');
    const yearSpan = document.getElementById('year');

    // --- Theme Toggle ---
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark-mode');
      themeToggle.textContent = document.body.classList.contains('dark-mode') ? 'Light Mode' : 'Dark Mode';
    });

    // --- Footer Year ---
    yearSpan.textContent = new Date().getFullYear();

    // --- Show/Hide Data Field ---
    function updateDataVisibility() {
      if(['POST','PUT','PATCH'].includes(method.value)) {
        dataGroup.style.display = 'block';
      } else {
        dataGroup.style.display = 'none';
      }
    }
    method.addEventListener('change', updateDataVisibility);
    updateDataVisibility();

    // --- Safe JSON Parse ---
    function parseJSON(text) {
      if(!text) return null;
      try { return JSON.parse(text); } 
      catch(e) { return 'INVALID_JSON'; }
    }

    // --- Copy Button Helper ---
    function setupCopyButton(buttonId, targetEl) {
      document.getElementById(buttonId).addEventListener('click', () => {
        navigator.clipboard.writeText(targetEl.textContent);
        alert('Copied to clipboard!');
      });
    }
    setupCopyButton('copy-request', requestEl);
    setupCopyButton('copy-response', responseEl);
    setupCopyButton('copy-error', errorEl);

    // --- Request History ---
    const historyKey = 'axiosRequestHistory';
    const historyList = document.getElementById('request-history');

    function loadHistory() {
      historyList.innerHTML = '';
      const history = JSON.parse(localStorage.getItem(historyKey) || '[]');
      history.forEach(req => {
        const li = document.createElement('li');
        li.style.display = 'flex';
        li.style.justifyContent = 'space-between';
        li.style.alignItems = 'center';
        li.style.marginBottom = '5px';

        const text = document.createElement('span');
        text.style.cursor = 'pointer';
        text.textContent = `${req.method} ${req.url}`;
        text.title = JSON.stringify(req, null, 2);
        text.addEventListener('click', () => {
          url.value = req.url;
          method.value = req.method;
          params.value = JSON.stringify(req.params || {}, null, 2);
          data.value = JSON.stringify(req.data || {}, null, 2);
          headers.value = JSON.stringify(req.headers || {}, null, 2);
          updateDataVisibility();
        });

        const copyBtn = document.createElement('button');
        copyBtn.textContent = 'Copy';
        copyBtn.className = 'btn btn-sm btn-outline-secondary';
        copyBtn.addEventListener('click', () => {
          navigator.clipboard.writeText(JSON.stringify(req, null, 2));
          alert('Copied to clipboard!');
        });

        li.appendChild(text);
        li.appendChild(copyBtn);
        historyList.appendChild(li);
      });
    }

    function saveToHistory(requestObj) {
      let history = JSON.parse(localStorage.getItem(historyKey) || '[]');
      history = history.filter(h => h.url !== requestObj.url || h.method !== requestObj.method);
      history.unshift(requestObj);
      history = history.slice(0, 5);
      localStorage.setItem(historyKey, JSON.stringify(history));
      loadHistory();
    }

    loadHistory();

    // --- Send Axios Request ---
    submit.addEventListener('click', () => {
      errorEl.textContent = 'None';
      responseEl.textContent = 'No Data';

      const options = {
        url: url.value || '/api',
        method: method.value,
        params: parseJSON(params.value),
        data: parseJSON(data.value),
        headers: parseJSON(headers.value)
      };

      for(const key of ['params','data','headers']) {
        if(options[key] === 'INVALID_JSON') {
          errorEl.textContent = `Invalid JSON in ${key}`;
          return;
        }
        if(options[key] === null) delete options[key];
      }

      requestEl.textContent = JSON.stringify(options, null, 2);

      axios(options)
        .then(res => {
          responseEl.textContent = JSON.stringify(res.data, null, 2);
          saveToHistory(options);
        })
        .catch(err => {
          if(err.response) errorEl.textContent = JSON.stringify(err.response.data, null, 2);
          else errorEl.textContent = err.message;
        });
    });
  </script>

</body>
</html>  
